---
title: "Tracking the Success of Nations"
author: "Chace Paulson"
date: 12-12-2018
output: pdf_document
---

```{r echo=FALSE, results='hide',message=FALSE, warning=FALSE}
# Sovereign Nations -------------------------------------------------------

# import sovereign nations data set 
library(readxl)
sovereign_nations <- read_excel("~/Downloads/final_proj/raw_data/sovereign_nations.xlsx")

library(tidyverse)
sovereign_nations <- as_tibble(sovereign_nations)

# rename columns
library(magrittr)
sovereign_nations <- sovereign_nations %>% 
  rename(country_name = `Soverign Nations`)

# Political Freedom -------------------------------------------------------

# load political freedom data 
library(readxl)
poli_freedom <- read_excel("~/Downloads/final_proj/raw_data/poli_freedom.xlsx")

library(tidyverse)
poli_freedom <- as_tibble(poli_freedom)

# rename columns in political freedom data 
colnames(poli_freedom)
poli_freedom <- poli_freedom %>% 
  rename(country_name = `Country/Territory`, 
         poli_status = Status, 
         poli_rights_rating = `PR Rating`, 
         civil_lib_rating = `CL Rating`, 
         poli_freedom = Total
  )

# create second data set only with columns we care about 
small_poli <- tibble("country_name" = poli_freedom$country_name, 
                         "poli_freedom" = poli_freedom$poli_freedom)

# Economic Freedom --------------------------------------------------------

# Load economic freedom data 
library(readxl)
econ_freedom <- read_excel("~/Downloads/final_proj/raw_data/econ_freedom.xls")

library(tidyverse)
econ_freedom <- as_tibble(econ_freedom)
colnames(econ_freedom)

# Rename columns in economic freedom data 
econ_freedom <- econ_freedom %>% 
  rename(
    countryID = `CountryID`, 
    country_name = `Country Name`,
    webname = WEBNAME, 
    region = Region, 
    world_rank = `World Rank`, 
    region_rank = `Region Rank`, 
    total_score = `2018 Score`, 
    property_rights = `Property Rights`, 
    judical_effectiveness = `Judical Effectiveness`, 
    govt_integrity = `Government Integrity`, 
    tax_burden = `Tax Burden`, 
    govt_spending = `Gov't Spending`, 
    fiscal_health = `Fiscal Health`, 
    bis_freedom = `Business Freedom`, 
    labor_freedom = `Labor Freedom`, 
    monetary_freedom = `Monetary Freedom`, 
    trade_freedom = `Trade Freedom`, 
    invest_freedom = `Investment Freedom`, 
    finance_freedom = `Financial Freedom`, 
    tariff_rate_perc = `Tariff Rate (%)`, 
    income_tax_rate_per = `Income Tax Rate (%)`, 
    corporate_tax_rate_per = `Corporate Tax Rate (%)`, 
    tax_burden_per_of_gdp = `Tax Burden % of GDP`, 
    govt_expenditure_per_of_gdp = `Gov't Expenditure % of GDP`, 
    country = Country, 
    pop_in_mil = `Population (Millions)`, 
    gdp_bill_ppp = `GDP (Billions, PPP)`, 
    gdp_growth_rate_perc = `GDP Growth Rate (%)`, 
    five_year_gdp_growth_rate_per = `5 Year GDP Growth Rate (%)`, 
    gdp_per_capita = `GDP per Capita (PPP)`, 
    unemployment_per = `Unemployment (%)`, 
    inflation_per = `Inflation (%)`, 
    fdi_inflow_mil = `FDI Inflow (Millions)`, 
    public_debt_per_of_gdp = `Public Debt (% of GDP)`
  )

colnames(econ_freedom)

# create second data set only with columns we care about 

small_econ <- tibble("country_name" = econ_freedom$country_name,
                         "region" = econ_freedom$region,
                         "econ_freedom" = econ_freedom$total_score)

# GDP ---------------------------------------------------------------------

# loading gdp data 
library(readxl)
gdp <- read_excel("~/Downloads/final_proj/raw_data/gdp.xlsx")

library(tidyverse)
gdp <- as_tibble(gdp)

# renaming columns in gdp data 
colnames(gdp)
gdp <- gdp %>% 
  rename(country_name = `Country Name`, 
         country_code = `Country Code`, 
         indicator_name = `Indicator Name`, 
         indicator_code = `Indicator Code`)
colnames(gdp)

# finding out if there is any missing data from the 2017 set 
sum(is.na(gdp$`2017`))

# merge with sovereign nations to keep only desired nations
gdp_mixed <- merge(sovereign_nations, gdp, all.x = TRUE)

# find out if there is still missing data from 2017 set now that we only 
# have the nations we are interested in 
sum(is.na(gdp_mixed$`2017`))
gdp_mixed$country_name[is.na(gdp_mixed$`2017`)]

# create a column of gdp_total to combine other years in to 
gdp_mixed$gdp_total <- gdp_mixed$`2017`

# for the countries with NAs for 2017, we will take data from 2016 instead
gdp_mixed$gdp_total[is.na(gdp_mixed$gdp_total)] <- 
  as.character(gdp_mixed$`2016`[is.na(gdp_mixed$gdp_total)]) 

# test for number of remaining NAs
sum(is.na(gdp_mixed$gdp_total))

# repeat but using 2015 data 
gdp_mixed$gdp_total[is.na(gdp_mixed$`gdp_total`)] <- 
  as.character(gdp_mixed$`2015`[is.na(gdp_mixed$gdp_total)]) 
sum(is.na(gdp_mixed$gdp_total))

# repeat using 2014 data 
gdp_mixed$gdp_total[is.na(gdp_mixed$`gdp_total`)] <- 
  as.character(gdp_mixed$`2014`[is.na(gdp_mixed$gdp_total)]) 
sum(is.na(gdp_mixed$gdp_total))

# repeat using 2013 data 
gdp_mixed$gdp_total[is.na(gdp_mixed$`gdp_total`)] <- 
  as.character(gdp_mixed$`2013`[is.na(gdp_mixed$gdp_total)]) 
sum(is.na(gdp_mixed$gdp_total))

# repeat using 2013 data 
gdp_mixed$gdp_total[is.na(gdp_mixed$`gdp_total`)] <- 
  as.character(gdp_mixed$`2012`[is.na(gdp_mixed$gdp_total)]) 
sum(is.na(gdp_mixed$gdp_total))

# since we continue to having a total of 6 NAs, we will stop here

# find out what countries are still missing gdp data
gdp_mixed$country_name[is.na(gdp_mixed$gdp_total)]

# create smaller data set with only the gdp_total and country_names columns
small_gdp <- tibble("country_name" = gdp_mixed$country_name, 
                        "gdp" = gdp_mixed$gdp_total)

# Unemployment Rate -------------------------------------------------------

# import unemployment data 
library(readxl)
unemployment <- read_excel("~/Downloads/final_proj/raw_data/unemployment.xlsx")

# renaming columns 
unemployment <- unemployment %>% 
  rename(country_name = `Country`, 
         unemployment_rate = `%`, 
         date = `Date of Info`)

# create small data set with just country_name and unemployment rate
small_unemployment <- tibble("country_name" = unemployment$country_name, 
                                 "unemployment" = unemployment$unemployment_rate)

# Crime Index -------------------------------------------------------------

# loading crime index data 
library(readxl)
crime_index <- read_excel("~/Downloads/final_proj/raw_data/crime_index.xlsx")

library(tidyverse)
crime_index <- as_tibble(crime_index)

# renaming columns in crime index data 
colnames(crime_index)
crime_index <- crime_index %>% 
  rename(rank = `Rank`,
         country_name = `Country Name`, 
         crime_index = `Crime Index`, 
         safety_index = `Safety Index`)
colnames(crime_index)

# merge with sovereign nations to keep only desired nations
crime_mixed <- merge(sovereign_nations, crime_index, all.x = TRUE)

# test for NAs 
sum(is.na(crime_mixed$crime_index))
crime_mixed$country_name[is.na(crime_mixed$crime_index)]

# create smaller tibble keeping only country_name and literacy
small_crime <- tibble("country_name" = crime_mixed$country_name, 
                          "crime_index" = crime_mixed$crime_index)

# Homicide Rate -----------------------------------------------------------

# loading homicide data 
library(readxl)
homicide <- read_excel("~/Downloads/final_proj/raw_data/homicide_rates.xlsx")

library(tidyverse)
homicide <- as_tibble(homicide)

# renaming columns in homicide data 
colnames(homicide)
homicide <- homicide %>% 
  rename(country_name = `Country Name`)
colnames(homicide)

# finding out if there is any missing data from the 2016 set 
sum(is.na(homicide$`2016`))

# merge with sovereign nations to keep only desired nations
homicide_mixed <- merge(sovereign_nations, homicide, all.x = TRUE)

# find out if there is still missing data from 2016 set now that we only 
# have the nations we are interested in 
sum(is.na(homicide_mixed$`2016`))
homicide_mixed$country_name[is.na(homicide_mixed$`2016`)]

# create a column of median_total to combine other years in to 
homicide_mixed$homicide_total <- homicide_mixed$`2016`

# for the countries with NAs for 2016, we will take data from 2015 instead
homicide_mixed$homicide_total[is.na(homicide_mixed$homicide_total)] <- 
  as.character(homicide_mixed$`2015`[is.na(homicide_mixed$homicide_total)]) 

# test for number of remaining NAs
sum(is.na(homicide_mixed$homicide_total))

# repeat but using 2014 data
homicide_mixed$homicide_total[is.na(homicide_mixed$homicide_total)] <- 
  as.character(homicide_mixed$`2014`[is.na(homicide_mixed$homicide_total)]) 
sum(is.na(homicide_mixed$homicide_total))

# repeat but using 2013 data
homicide_mixed$homicide_total[is.na(homicide_mixed$homicide_total)] <- 
  as.character(homicide_mixed$`2013`[is.na(homicide_mixed$homicide_total)]) 
sum(is.na(homicide_mixed$homicide_total))

# repeat but using 2012 data
homicide_mixed$homicide_total[is.na(homicide_mixed$homicide_total)] <- 
  as.character(homicide_mixed$`2012`[is.na(homicide_mixed$homicide_total)]) 
sum(is.na(homicide_mixed$homicide_total))

# repeat but using 2011 data
homicide_mixed$homicide_total[is.na(homicide_mixed$homicide_total)] <- 
  as.character(homicide_mixed$`2011`[is.na(homicide_mixed$homicide_total)]) 
sum(is.na(homicide_mixed$homicide_total))

# repeat but using 2010 data
homicide_mixed$homicide_total[is.na(homicide_mixed$homicide_total)] <- 
  as.character(homicide_mixed$`2010`[is.na(homicide_mixed$homicide_total)]) 
sum(is.na(homicide_mixed$homicide_total))

# repeat but using 2009 data
homicide_mixed$homicide_total[is.na(homicide_mixed$homicide_total)] <- 
  as.character(homicide_mixed$`2009`[is.na(homicide_mixed$homicide_total)]) 
sum(is.na(homicide_mixed$homicide_total))

# repeat but using 2008 data
homicide_mixed$homicide_total[is.na(homicide_mixed$homicide_total)] <- 
  as.character(homicide_mixed$`2008`[is.na(homicide_mixed$homicide_total)]) 
sum(is.na(homicide_mixed$homicide_total))

# repeat but using 2007 data
homicide_mixed$homicide_total[is.na(homicide_mixed$homicide_total)] <- 
  as.character(homicide_mixed$`2007`[is.na(homicide_mixed$homicide_total)]) 
sum(is.na(homicide_mixed$homicide_total))

# repeat but using 2006 data
homicide_mixed$homicide_total[is.na(homicide_mixed$homicide_total)] <- 
  as.character(homicide_mixed$`2006`[is.na(homicide_mixed$homicide_total)]) 
sum(is.na(homicide_mixed$homicide_total))

# repeat but using 2005 data
homicide_mixed$homicide_total[is.na(homicide_mixed$homicide_total)] <- 
  as.character(homicide_mixed$`2005`[is.na(homicide_mixed$homicide_total)]) 
sum(is.na(homicide_mixed$homicide_total))

# repeat but using 2004 data
homicide_mixed$homicide_total[is.na(homicide_mixed$homicide_total)] <- 
  as.character(homicide_mixed$`2004`[is.na(homicide_mixed$homicide_total)]) 
sum(is.na(homicide_mixed$homicide_total))

# since we continue to having a total of 3 NAs, we will stop here

# find out what countries are still missing homicide data
homicide_mixed$country_name[is.na(homicide_mixed$homicide_total)]

# create smaller data set with only the homicide_total and country_names columns
small_homicide <- tibble("country_name" = homicide_mixed$country_name, 
                             "homicide" = homicide_mixed$homicide_total)

# Secondary School Enrollment Rate ----------------------------------------

# loading enrollment data 
library(readxl)
enrollment <- read_excel("~/Downloads/final_proj/raw_data/secondary_enrollment.xlsx")

library(tidyverse)
enrollment <- as_tibble(enrollment)

# renaming columns in enrollment data 
colnames(enrollment)
enrollment <- enrollment %>% 
  rename(country_name = `Country Name`)
colnames(enrollment)

# finding out if there is any missing data from the 2016 set 
sum(is.na(enrollment$`2016`))

# merge with sovereign nations to keep only desired nations
enrollment_mixed <- merge(sovereign_nations, enrollment, all.x = TRUE)

# find out if there is still missing data from 2016 set now that we only 
# have the nations we are interested in 
sum(is.na(enrollment_mixed$`2016`))
enrollment_mixed$country_name[is.na(enrollment_mixed$`2016`)]

# create a column of median_total to combine other years in to 
enrollment_mixed$enrollment_total <- enrollment_mixed$`2016`

# for the countries with NAs for 2016, we will take data from 2015 instead
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2015`[is.na(enrollment_mixed$enrollment_total)]) 

# test for number of remaining NAs
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2014 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2014`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2013 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2013`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2012 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2012`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2011 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2011`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2010 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2010`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2009 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2009`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2008 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2008`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2007 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2007`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2006 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2006`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2005 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2005`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2004 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2004`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2003 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2003`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2002 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2002`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2001 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2001`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# repeat but using 2000 data
enrollment_mixed$enrollment_total[is.na(enrollment_mixed$enrollment_total)] <- 
  as.character(enrollment_mixed$`2000`[is.na(enrollment_mixed$enrollment_total)]) 
sum(is.na(enrollment_mixed$enrollment_total))

# since we continue to having a total of 11 NAs, we will stop here

# merge with sovereign nations to keep only desired nations
enrollment_mixed <- merge(sovereign_nations, enrollment_mixed, all.x = TRUE)

# find out what countries are still missing enrollment data
sum(is.na(enrollment_mixed$enrollment_total))
enrollment_mixed$country_name[is.na(enrollment_mixed$enrollment_total)]

# create smaller data set with only the enrollment_total and country_names columns
small_enrollment <- tibble("country_name" = enrollment_mixed$country_name, 
                               "enrollment" = enrollment_mixed$enrollment_total)

# Literacy Rate -----------------------------------------------------------

# import literacy rates data set 
library(readxl)
literacy <- read_excel("~/Downloads/final_proj/raw_data/literacy_rates2.xlsx")

library(tidyverse)
literacy <- as_tibble(literacy)

# rename columns in the data set
library(magrittr)
colnames(literacy)
literacy <- literacy %>% 
  rename(country_name = `COUNTRY`, 
         definition = `DEFINITION`, 
         total = `TOTAL POPULATION`, 
         male = `MALE`, 
         female = `FEMALE`, 
         note = `NOTE`)
colnames(literacy)
head(literacy)

# split the strings to start removing repetition
literacy2 <- str_split_fixed(literacy$definition, ": ", n = 2)
literacy3 <- str_split_fixed(literacy$total, ": ", n = 2)
literacy4 <- str_split_fixed(literacy$male, ": ", n = 2)
literacy5 <- str_split_fixed(literacy$female, ": ", n = 2)

# convert to tibbles
literacy2 <- as.tibble(literacy2)
literacy3 <- as.tibble(literacy3)
literacy4 <- as.tibble(literacy4)
literacy5 <- as.tibble(literacy5)

# rename column names
literacy2 %<>% 
  rename(definition = `V2`)
literacy3 %<>% 
  rename(total = `V2`)
literacy4 %<>% 
  rename(male = `V2`)
literacy5 %<>% 
  rename(female = `V2`)

# create new data frame with only the columns of interest
fixed_literacy <- tibble("country_name" = literacy$country_name, 
                             "definition" = literacy2$definition, 
                             "total" = literacy3$total, 
                             "male" = literacy4$male, 
                             "female" = literacy5$female, 
                             "note" = literacy$note)
fixed_literacy <- as.tibble(fixed_literacy)

# remove percent sign from data 
fixed_literacy$total <- 
  substr(fixed_literacy$total, 1, 
         nchar(fixed_literacy$total)-1)

# merge with sovereign nations to keep only desired nations
literacy_mixed <- merge(sovereign_nations, fixed_literacy, all.x = TRUE)

# test for NAs 
sum(is.na(literacy_mixed$total))
literacy_mixed$country_name[is.na(literacy_mixed$total)]

# create smaller tibble keeping only country_name and literacy
small_literacy2 <- tibble("country_name" = literacy_mixed$country_name, 
                              "literacy" = literacy_mixed$total)

# Life Expectancy Rate ----------------------------------------------------

# import life expectancy rates data set 
library(readxl)
life_expectancy <- read_excel("~/Downloads/final_proj/raw_data/life_expectancy.xlsx")

library(tidyverse)
life_expectancy <- as_tibble(life_expectancy)

# rename columns in the data set
library(magrittr)
colnames(life_expectancy)
life_expectancy <- life_expectancy %>% 
  rename(country_name = `Country Name`, 
         life_expectancy = `Life Expectancy`)
colnames(life_expectancy)

# split the string in column 1 to put the country_name in the second column
life2 <- NA
life2 <- str_split_fixed(life_expectancy$country_name, " ", n = 2)

# convert to tibble and rename columns
life2 <- as.tibble(life2)
life2 <- life2 %>% 
  rename(country_id = `V1`, 
         country_name = `V2`) 
life2$life_expectancy <- NA

# trim the leading white spaces off of the country_name column
head(life2)
life2$country_name <- trimws(life2$country_name)

# put the life_expectancy rates into third column
library(dplyr)
life2 <- life2 %>% 
  separate(country_name, into = c("country_name", "life_expectancy"), 
           sep = "(?<=[a-zA-Z])\\s*(?=[0-9])")
head(life2)

# merge with sovereign nations to keep only desired nations
life_mixed <- merge(sovereign_nations, life2, all.x = TRUE)

# test for NAs 
sum(is.na(life_mixed$life_expectancy))
life_mixed$country_name[is.na(life_mixed$life_expectancy)]

# create smaller tibble keeping only country_name and life_expectancy 
small_life <- tibble("country_name" = life_mixed$country_name, 
                         "life_expectancy" = life_mixed$life_expectancy)

# Infant Mortality Rate ---------------------------------------------------

# import infant mortality rates data set 
library(readxl)
infant_mortality <- read_excel("~/Downloads/final_proj/raw_data/infant_mortality.xlsx")

library(tidyverse)
infant_mortality <- as_tibble(infant_mortality)

# rename columns in the data set
library(magrittr)
colnames(infant_mortality)
infant_mortality <- infant_mortality %>% 
  rename(country_name = `Country Name`, 
         infant_mortality = `Infant Mortality Rate`)
colnames(infant_mortality)

# split the string in column 1 to put the country_name in the second column
infant2 <- NA
infant2 <- str_split_fixed(infant_mortality$country_name, " ", n = 2)

# convert to tibble and rename columns
infant2 <- as.tibble(infant2)
infant2 <- infant2 %>% 
  rename(country_id = `V1`, 
         country_name = `V2`) 
infant2$infant_mortality <- NA

# trim the leading white spaces off of the country_name column
head(infant2)
infant2$country_name <- trimws(infant2$country_name)

# put the infant_mortality rates into third column
library(dplyr)
infant2 <- infant2 %>% 
  separate(country_name, into = c("country_name", "infant_mortality"), 
           sep = "(?<=[a-zA-Z])\\s*(?=[0-9])")
head(infant2)

# merge with sovereign nations to keep only desired nations
infant_mixed <- merge(sovereign_nations, infant2, all.x = TRUE)

# test for NAs 
sum(is.na(infant_mixed$infant_mortality))
infant_mixed$country_name[is.na(infant_mixed$infant_mortality)]

# create smaller tibble keeping only country_name and infant_mortality 
small_infant <- tibble("country_name" = infant_mixed$country_name, 
                           "infant_mortality" = infant_mixed$infant_mortality)

# Median Income -----------------------------------------------------------

# loading median income data 
library(readxl)
median_income <- read_excel("~/Downloads/final_proj/raw_data/median_income.xlsx")

library(tidyverse)
median_income <- as_tibble(median_income)

# renaming columns in median income data 
colnames(median_income)
median_income <- median_income %>% 
  rename(country_name = `Country Name`)
colnames(median_income)

# finding out if there is any missing data from the 2016 set 
sum(is.na(median_income$`2016`))

# merge with sovereign nations to keep only desired nations
median_mixed <- merge(sovereign_nations, median_income, all.x = TRUE)

# find out if there is still missing data from 2016 set now that we only 
# have the nations we are interested in 
sum(is.na(median_mixed$`2016`))
median_mixed$country_name[is.na(median_mixed$`2016`)]

# create a column of median_total to combine other years in to 
median_mixed$median_total <- median_mixed$`2016`

# for the countries with NAs for 2016, we will take data from 2015 instead
median_mixed$median_total[is.na(median_mixed$median_total)] <- 
  as.character(median_mixed$`2015`[is.na(median_mixed$median_total)]) 

# test for number of remaining NAs
sum(is.na(median_mixed$median_total))

# repeat but using 2014 data 
median_mixed$median_total[is.na(median_mixed$median_total)] <- 
  as.character(median_mixed$`2014`[is.na(median_mixed$median_total)]) 
sum(is.na(median_mixed$median_total))

# repeat but using 2013 data 
median_mixed$median_total[is.na(median_mixed$median_total)] <- 
  as.character(median_mixed$`2013`[is.na(median_mixed$median_total)]) 
sum(is.na(median_mixed$median_total))

# repeat but using 2012 data 
median_mixed$median_total[is.na(median_mixed$median_total)] <- 
  as.character(median_mixed$`2012`[is.na(median_mixed$median_total)]) 
sum(is.na(median_mixed$median_total))

# repeat but using 2011 data 
median_mixed$median_total[is.na(median_mixed$median_total)] <- 
  as.character(median_mixed$`2011`[is.na(median_mixed$median_total)]) 
sum(is.na(median_mixed$median_total))

# repeat but using 2010 data 
median_mixed$median_total[is.na(median_mixed$median_total)] <- 
  as.character(median_mixed$`2010`[is.na(median_mixed$median_total)]) 
sum(is.na(median_mixed$median_total))

# repeat but using 2009 data 
median_mixed$median_total[is.na(median_mixed$median_total)] <- 
  as.character(median_mixed$`2009`[is.na(median_mixed$median_total)]) 
sum(is.na(median_mixed$median_total))

# repeat but using 2008 data 
median_mixed$median_total[is.na(median_mixed$median_total)] <- 
  as.character(median_mixed$`2008`[is.na(median_mixed$median_total)]) 
sum(is.na(median_mixed$median_total))

# since we continue to having a total of 20 NAs, we will stop here

# find out what countries are still missing median income data
median_mixed$country_name[is.na(median_mixed$median_total)]

# create smaller data set with only the median_total and country_names columns
small_median_income <- tibble("country_name" = median_mixed$country_name, 
                                  "median_income" = median_mixed$median_total)

# World Happiness Rating --------------------------------------------------

# import happiness data set 
library(readxl)
happiness <- read_excel("~/Downloads/final_proj/raw_data/world_happiness_rating.xlsx")

library(tidyverse)
happiness <- as_tibble(happiness)

# rename columns in the data set
library(magrittr)
colnames(happiness)
happiness <- happiness %>% 
  rename(country_name = `Country Name`, 
         happiness_rating = `World Happiness Rating`)
colnames(happiness)

# split the string in column 1 to put the ratings in the second column
happiness <- happiness %>% 
  separate(country_name, into = c("country_name", "happiness_rating"), sep = "\\(")

# removing the white space at the end of the country name
happiness$country_name <- trimws(happiness$country_name)

# removing the parentheses at the end of the happiness rating
happiness$happiness_rating <- 
  substr(happiness$happiness_rating, 1, 
         nchar(happiness$happiness_rating)-1)

# merge with sovereign nations to keep only desired nations
happiness_mixed <- merge(sovereign_nations, happiness, all.x = TRUE)

# test for NAs 
sum(is.na(happiness_mixed))
happiness_mixed$country_name[is.na(happiness_mixed$happiness_rating)]

# Success Data ------------------------------------------------------------

# merge all of the small_econ and small_poli data into one data frame 
small_data <- merge(small_econ, small_poli, all.x = TRUE, all.y = TRUE)

# check if there are countrys not in our sovereign_nation data in 
# the small_data
setdiff(sovereign_nations$country_name, small_data$country_name)
setdiff(small_data$country_name, sovereign_nations$country_name)

# eliminate all countrys not in our sovereign_nation data 
success_data <- merge(sovereign_nations, small_data, all.x = TRUE)

# check that only the countrys from the soverign_nation data remain
nrow(success_data)
nrow(sovereign_nations)
setdiff(sovereign_nations$country_name, success_data$country_name)
setdiff(success_data$country_name, sovereign_nations$country_name)

# merge in the gdp data 
success_data <- merge(success_data, small_gdp, all.x = TRUE)

# merge in the unemployment data 
success_data <- merge(success_data, small_unemployment, all.x = TRUE)

# merge in crime rate data
success_data <- merge(success_data, small_crime, all.x = TRUE)

# merge in homicide data 
success_data <- merge(success_data, small_homicide, all.x = TRUE)

# merge in high school enrollment data
success_data <- merge(success_data, small_enrollment, all.x = TRUE)

# merge in the literacy data 
success_data <- merge(success_data, small_literacy2, all.x = TRUE)

# merge in the life expectancy data 
success_data <- merge(success_data, small_life, all.x = TRUE)

# merge in the infant mortality data 
success_data <- merge(success_data, small_infant, all.x = TRUE)

# merge in the median income data 
success_data <- merge(success_data, small_median_income, all.x = TRUE)

# merge in the happiness data 
success_data <- merge(success_data, happiness_mixed, all.x = TRUE)

# check to make sure all columns have been inputted
colnames(success_data)
ncol(success_data)

# turn data frame into tibble
success_data <- as.tibble(success_data)

# find the types for each column 
typeof(success_data$econ_freedom)
typeof(success_data$poli_freedom)
typeof(success_data$gdp)
typeof(success_data$unemployment)
typeof(success_data$crime_index)
typeof(success_data$homicide)
typeof(success_data$enrollment)
typeof(success_data$literacy)
typeof(success_data$life_expectancy)
typeof(success_data$infant_mortality)
typeof(success_data$median_income)
typeof(success_data$happiness_rating)

# convert the character strings into numeric 
success_data$econ_freedom <- 
  as.numeric(as.character(success_data$econ_freedom))
success_data$gdp <- 
  as.numeric(as.character(success_data$gdp))
success_data$homicide <- 
  as.numeric(as.character(success_data$homicide))
success_data$enrollment <- 
  as.numeric(as.character(success_data$enrollment))
success_data$literacy <- 
  as.numeric(as.character(success_data$literacy))
success_data$life_expectancy <- 
  as.numeric(as.character(success_data$life_expectancy))
success_data$infant_mortality <- 
  as.numeric(as.character(success_data$infant_mortality))
success_data$median_income <- 
  as.numeric(as.character(success_data$median_income))
success_data$happiness_rating <- 
  as.numeric(as.character(success_data$happiness_rating))

# check to ensure that all columns are now doubles
typeof(success_data$econ_freedom)
typeof(success_data$poli_freedom)
typeof(success_data$gdp)
typeof(success_data$unemployment)
typeof(success_data$crime_index)
typeof(success_data$homicide)
typeof(success_data$enrollment)
typeof(success_data$literacy)
typeof(success_data$life_expectancy)
typeof(success_data$infant_mortality)
typeof(success_data$median_income)
typeof(success_data$happiness_rating)
```

```{r echo=FALSE, results='hide',message=FALSE,warning=FALSE}
# Success Pct -------------------------------------------------------------

# check over data 
head(success_data)
colnames(success_data)

# create a new tibble for percentages 
success_pct <- tibble("country_name" = success_data$country_name, 
                      "region" = success_data$region)

# add in the economic freedom data
head(success_data$econ_freedom)
success_pct$econ_freedom <- success_data$econ_freedom / 100

# add in the political freedom data 
head(success_data$poli_freedom)
success_pct$poli_freedom <- success_data$poli_freedom / 100

# add in the gdp data 
# since gdp is not easily converted in a pct, will find the max gdp and 
# divide the rest by the max to create a pct 
head(success_data$gdp)
max_gdp <- max(success_data$gdp, na.rm = TRUE)
success_pct$gdp <- success_data$gdp / max_gdp

# add in the unemployment data 
# since high unemployment harms a country's success, we want to subtract 
# the pct by 1 to find a positive idicator (i.e. the employment rate)
head(success_data$unemployment)
success_pct$unemployment <- 1 - (success_data$unemployment / 100)

# add in the crime index data
# since high crime index harms a country's success, we want to subtract 
# the pct by 1 to find a positive idicator (i.e. the safety index)
head(success_data$crime_index)
success_pct$crime_index <- 1 - (success_data$crime_index / 100)

# add in the homicide rate data 
# subtract by 1 to find a positive indicator 
head(success_data$homicide)
success_pct$homicide <- 1 - (success_data$homicide / 100)

# add in the enrollment data 
head(success_data$enrollment)
max_enrollment <- max(success_data$enrollment, na.rm = TRUE)
success_pct$enrollment <- success_data$enrollment / max_enrollment

# add in the literacy data 
head(success_data$literacy)
success_pct$literacy <- success_data$literacy / 100

# add in the life expectancy data
head(success_data$life_expectancy)
max_life <- max(success_data$life_expectancy, na.rm = TRUE)
success_pct$life_expectancy <- success_data$life_expectancy / max_life

# add in the infant mortality data 
# subtract by 1 to find a positive indicator 
head(success_data$infant_mortality)
max_infant <- max(success_data$infant_mortality, na.rm = TRUE)
success_pct$infant_mortality <- 
  1 - (success_data$infant_mortality / max_infant)

# add in the median income data 
head(success_data$median_income)
max_income <- max(success_data$median_income, na.rm = TRUE)
success_pct$median_income <- success_data$median_income / max_income

# add in the happiness rating data 
head(success_data$happiness_rating)
max_happiness <- max(success_data$happiness_rating, na.rm = TRUE)
success_pct$happiness <- success_data$happiness_rating / max_happiness

# calculate the success rating for each country 
# since many countries have at least one NA for their data, we cannot 
# simply add the columns up and will instead need to find the mean
ncol(success_pct)
colnames(success_pct)

success_pct$success <- NA
success_pct$success <- rowMeans(success_pct[,5:14], na.rm=TRUE)

# Success NA --------------------------------------------------------------
# considering success on the basis of five categories: 
# 1. economic prosperity 
# 2. safety 
# 3. education 
# 4. health 
# 5. lifestyle

# each category was given two different variables 

# any country that is missing data for both variables in any of the 
# categories needs to be removed
success_na <- success_pct

colnames(success_pct)

success_na <- 
  success_na[rowSums(is.na(success_na[c("gdp", "unemployment")])) != 2, ]
success_na <- 
  success_na[rowSums(is.na(success_na[c("crime_index", "homicide")])) != 2, ]
success_na <- 
  success_na[rowSums(is.na(success_na[c("enrollment", "literacy")])) != 2, ]
success_na <- 
  success_na[rowSums(is.na(success_na[c("life_expectancy", "infant_mortality")])) != 2, ]
success_na <- 
  success_na[rowSums(is.na(success_na[c("median_income", "happiness")])) != 2, ]

# count number of remaining countries from the original 195 
nrow(success_na)

# Success Combine ---------------------------------------------------------
# create new tibble where the two variables are combines into one for each 
# of the five categories 
success_combine <- tibble("country_name" = success_na$country_name, 
                          "region" = success_na$region, 
                          "poli_freedom" = success_na$poli_freedom, 
                          "econ_freedom" = success_na$econ_freedom)
colnames(success_na)

# economy 
success_combine$econ <- 
  rowMeans(success_na[,c("gdp", "unemployment")], na.rm=TRUE)

# safety
success_combine$safe <- 
  rowMeans(success_na[,c("crime_index", "homicide")], na.rm=TRUE)

# education 
success_combine$educ <- 
  rowMeans(success_na[,c("enrollment", "literacy")], na.rm=TRUE)

# health 
success_combine$health <- 
  rowMeans(success_na[,c("life_expectancy", "infant_mortality")], na.rm=TRUE)

# lifestyle
success_combine$life <- 
  rowMeans(success_na[,c("median_income", "happiness")], na.rm=TRUE)

# add success calculations back 
success_combine$success <- success_na$success

# find the least successful countries
success_bot3 <- success_combine %>% top_n(-10)

# find the most successful countries
success_top3 <- success_combine %>% top_n(10)


# basic statistics --------------------------------------------------------
mean(success_na$success) 
# 0.6117207

min(success_na$success) 
# 0.3012778

success_na %>% top_n(-1) 
# South Sudan

max(success_na$success) 
# 0.9071793

success_na %>% top_n(1) 
# Tawain 

# find rank ---------------------------------------------------------------

# arrange data by success
success_order <- success_na %>% 
  arrange(desc(success))
nrow(success_order)
success_order$rank <- 1:179

# find the least successful countries
success_bot <- success_na %>% top_n(-10)

# find the most successful countries
success_top <- success_na %>% top_n(10)

# create tibbles keeping only countries and success scores
success_bot2 <- tibble("country" = success_bot$country_name, 
                       "success" = success_bot$success)
success_top2 <- tibble("country" = success_top$country_name, 
                       "success" = success_top$success)

# create tibbles keeping only countries and freedom/success scores
success_bot3 <- tibble("country" = success_bot$country_name, 
                       "econ" = success_bot$econ_freedom, 
                       "poli" = success_bot$poli_freedom,
                       "success" = success_bot$success)
success_top3 <- tibble("country" = success_top$country_name, 
                       "econ" = success_top$econ_freedom, 
                       "poli" = success_top$poli_freedom, 
                       "success" = success_top$success)
```

# Research Question 

The objective of the following paper is to track and analyze the effect that economic and political freedom have on the overall success of a nation. 

The paper will first detail which nations are ranked highest/lowest in terms of success as well as which regions throughout the world have the highest rates of success. Further, the paper will investigate if there is a positive correlation between economic freedom and success as well as political freedom and succes, i.e. will the rate of success rise in a consistent, positive trend as the rate of economic freedom or political freedom increases. Finally, the research will track whether there is a greater correlation between the type of government or the economic system in how successful a nation is.

# Background

While vast amounts of studies have been released on the effects of political freedom on economic freedom, or vice versa, few studies have attempted to track the effects of either on the overall success of the nation. Thus, well the relationship has been well established in which economic freedom increases political freedom, most studies ignore what role these two might play into other areas. 

For the research, two data sets were integral - the Heritage Foundation's Index of Economic Freedom and Freedom House's Freedom Rating. The former measures the degree of economic freedom in the world's nations through multivariate statistics and the latter measures the degree of civil liberties and political rights in the world's nations. Both data sets are not without their critics; however, the goal is to eliminate some of the potential bias from the data sets through the research design. Hertiage's Index of Economic Freedom drew wide criticism due to its assumption that economic openness inherently leads to growth within a nation. By creating a new measure of success (as outlined below), the goal is to create a more rounded picture of what it means to be a successful nation within this study, including more than just economic indicators. 

# Defining Success 

In order to calculate the success of a nation, the term "success" must first be defined. For the sake of the following research, a successful nation has been defined as one that has attained high levels of economic prosperity, education, safety, and health among its population as well as an overall positive quality of life. When combined, these five categories should work together to create a successful citizenry and nation. 

In order to measure the categories, then, two variables have been assigned to each of the five: economic prosperity (GDP, unemployment rate), safety (crime index, homicide rate), education (secondary school enrollment rate, literacy rate), health (life expectancy, infant mortality), and quality of life/lifestyle (median income, world happiness rating). By measuring each of the five predictors with the same number of variables, no category will be weighted as more crucial in the success of a nation than any of the others. 

By including five different categories and weighting them evenly, the risk of preferential treatment towards one category will be removed. In many previous studies of the success of countries, research focused solely on economic factors (or weighted them heavier than other variables). However, under this current study, the goal is to gain a more robust picture of what success means and looks like for a nation; thus, it becomes necessary to weight economic prosperity the same as the remaining four categories. 

# Calculating Success 

The first step in the research design was to decide which nations would be considered. The list of 196 nations currently recognized by the U.S. Department of State as sovereign was used as the standard measure - thereby eliminating any other countries or territories included in the data sets that were not included within this list. The data from the sovereign nations, economic freedom, political freedom, and the ten variables were then inputted in to R, tidied, and merged into one tibble. 

The next step, then, was to calculate success from this tibble. Since variables came in the form of years, dollars, rates, percentages, etc., a standard measure needed to be utilized across all ten of the variable. In order to create this standard measures, proportions were utilized. Taking the maximum value for a variable (or the maximum possible in the case of the freedom scores and happiness rating), each value was divided by its column's maximum. For negative measures, such as homicide rate, where a lower value was ideal, the proportion was then divided by 1. The goal of this was to create a trend across all ten variables in which a higher value would denote more success in the category. The overall success rate was given, then, by calculating the mean of the ten variables for each nation. 

In order to ensure that each category continued to be weighted evenly, the issue of missing values needed to be dealt with. Any nation that was missing data from both variables within any of the five categories was, thus, removed from consideration. This ensured that the mean rate that was given in the calculation of success actually represented all five categories rather than four or less. After removing rows (nations) with missing values in both columns of one category or more, 179 or the original 195 nations remained. 

Nations were then reordered by their success rating and a rank was given to each nation. 

The following tibble was created through this proccess:

```{r}
head(success_order)
```

# Comparing Economic/Political Freedom and Success 

```{r echo=FALSE, results='hide',message=FALSE, warning=FALSE}
# loading country code data 
library(readxl)
country_code <- read_excel("~/Downloads/final_proj/raw_data/country_code.xlsx")

library(tidyverse)
country_code <- as_tibble(country_code)
colnames(country_code)

# clean up data
country_code <- str_split_fixed(country_code$code, " ", 2)
country_code <- as.tibble(country_code)
colnames(country_code)
country_code <- country_code %>% 
  rename(code = `V1`, 
         country = `V2`)
colnames(country_code)

# trim the leading white spaces off of the columns
head(infant2)
country_code$country <- trimws(country_code$country)
country_code$code <- trimws(country_code$code)

# merge country_code with countries from study 
my_countries <- tibble("country" = success_na$country_name)
my_countries$country <- trimws(my_countries$country)

my_countries <- merge(my_countries, country_code, all.x = TRUE)

# merge my_countries with success data
success_code <- success_na
success_code <- success_code %>% 
  rename(country = country_name)

success_code <- merge(success_code, my_countries, all.x = TRUE)
```

## Success Ratings 

The following map depicts the success within each given nation, with the darker shades showing the more successful free nations and the lighter showing the less free:
```{r echo=FALSE}
# create map --------------------------------------------------------------
library(rworldmap)

# countries data frame 
theCountries <- success_code$code

# data frame with success and country code
sDF <- data.frame(country = success_code$code, 
                    success = success_code$success)

# join data frame to map
sMap <- joinCountryData2Map(sDF, joinCode = "ISO3",
                              nameJoinColumn = "country")

# create map
mapCountryData(sMap, nameColumnToPlot="success", catMethod = "quantiles",
               missingCountryCol = gray(.8), mapTitle = "Success of Nations")
```

## Political Freedom

The following map depicts the political freedom within each given nation, with the darker shades showing the more politically free nations and the lighter showing the less free:
```{r echo=FALSE}
# repeat for poli freedom  ------------------------------------------------

# data frame with success and country code
pDF <- data.frame(country = success_code$code, 
                  success = success_code$poli_freedom)

# join data frame to map
pMap <- joinCountryData2Map(pDF, joinCode = "ISO3",
                            nameJoinColumn = "country")

# create map
mapCountryData(pMap, nameColumnToPlot="success", catMethod = "quantiles",
               missingCountryCol = gray(.8), mapTitle = "Poli Freedom of Nations")
```

## Economic Freedom

The following map depicts the economic freedom within each given nation, with the darker shades showing the more economically free nations and the lighter showing the less free:
```{r echo=FALSE}
# repeat for econ freedom -------------------------------------------------

# data frame with success and country code
eDF <- data.frame(country = success_code$code, 
                  success = success_code$econ_freedom)

# join data frame to map
eMap <- joinCountryData2Map(eDF, joinCode = "ISO3",
                            nameJoinColumn = "country")

# create map
mapCountryData(eMap, nameColumnToPlot="success", catMethod = "quantiles",
               missingCountryCol = gray(.8), mapTitle = "Econ Freedom of Nations")
```

## Comparing the Three 

When comparing the three maps to one another, it becomes clear that the three models rate the regions of the world very differently. Success favors rates the Asia-Pacific region more favorably then either political freedom or economic freedom does. Additionally, success's rating of South America falls much more in line with the political freedom model than economic freedom. Lastly, both political and economic freedom rate the southern region of Africa more favorably than the success rate model does. 


# Success by Region 

The following section investigates this topic further by tracking the numerical differences in success between the regions in the three models. 

## Political Freedom 

Under the political freedom model, the most successful region is Europe with an average freedom rating of 0.812 out of 1.0 and the least successful region is the Middle East / North Africa with an average freedom rating of 0.288. The following tibble includes the mean political freedom rating for each of the five regions. 

```{r echo=FALSE, results='hide',message=FALSE, warning=FALSE}
# region data 
colnames(success_na)
unique(success_na$region)

# calculate means for each region
mean_ap <- 
  mean(success_na$poli_freedom[success_na$region == "Asia-Pacific"], na.rm = TRUE)
mean_eu <-
  mean(success_na$poli_freedom[success_na$region == "Europe"], na.rm = TRUE)
mean_mena <-
  mean(success_na$poli_freedom[success_na$region == "Middle East / North Africa"], na.rm = TRUE)
mean_ssa <-
  mean(success_na$poli_freedom[success_na$region == "Sub-Saharan Africa"], na.rm = TRUE)
mean_am <-
  mean(success_na$poli_freedom[success_na$region == "Americas"], na.rm = TRUE)

# create a tibble of values
df_region_poli <- tibble("region" = c("Asia-Pacific", "Europe", 
                                 "Middle East / North Africa", 
                                 "Sub-Saharan Africa", "Americas"), 
                    "mean" = c(mean_ap, mean_eu, mean_mena, mean_ssa, mean_am))
```

```{r}
df_region_poli
```

## Economic Freedom 

Under the economic freedom model, the most successful region is Europe with an average freedom rating of 0.689 out of 1.0 and the least successful region is Sub-Saharan Africa with an average rating of 0.546. As is evidenced by the following tibble that includes the mean economic freedom ratings for each of the five regions, there is much less variation between the regions than there is under the other two models:

```{r echo=FALSE, results='hide',message=FALSE, warning=FALSE}
# region data 
colnames(success_na)
unique(success_na$region)

# calculate means for each region
mean_ap <- 
  mean(success_na$econ_freedom[success_na$region == "Asia-Pacific"], na.rm = TRUE)
mean_eu <-
  mean(success_na$econ_freedom[success_na$region == "Europe"], na.rm = TRUE)
mean_mena <-
  mean(success_na$econ_freedom[success_na$region == "Middle East / North Africa"], na.rm = TRUE)
mean_ssa <-
  mean(success_na$econ_freedom[success_na$region == "Sub-Saharan Africa"], na.rm = TRUE)
mean_am <-
  mean(success_na$econ_freedom[success_na$region == "Americas"], na.rm = TRUE)
# create a tibble of values
df_region_econ <- tibble("region" = c("Asia-Pacific", "Europe", 
                                 "Middle East / North Africa", 
                                 "Sub-Saharan Africa", "Americas"), 
                    "mean" = c(mean_ap, mean_eu, mean_mena, mean_ssa, mean_am))
```

```{r}
df_region_econ
```

## Success Rating 

Under the success model, the most successful region is, again, Europe with an average rating of 0.711 out of 1.0 and the least successful region is Sub-Saharan Africa with an average rating of 0.491. The following tibble includes the mean success ratings for each of the five regions: 

```{r echo=FALSE, results='hide',message=FALSE, warning=FALSE}
# region data 
colnames(success_na)
unique(success_na$region)

# calculate means for each region
mean_ap <- 
  mean(success_na$success[success_na$region == "Asia-Pacific"], na.rm = TRUE)
mean_eu <-
  mean(success_na$success[success_na$region == "Europe"], na.rm = TRUE)
mean_mena <-
  mean(success_na$success[success_na$region == "Middle East / North Africa"], na.rm = TRUE)
mean_ssa <-
  mean(success_na$success[success_na$region == "Sub-Saharan Africa"], na.rm = TRUE)
mean_am <-
  mean(success_na$success[success_na$region == "Americas"], na.rm = TRUE)

# create a tibble of values
df_region <- tibble("region" = c("Asia-Pacific", "Europe", 
                               "Middle East / North Africa", 
                               "Sub-Saharan Africa", "Americas"), 
                  "mean" = c(mean_ap, mean_eu, mean_mena, mean_ssa, mean_am))
```

```{r}
df_region
```

## Comparing the Three 

Under all three models, Europe is consistently the region with the highest average score - making it the most politically/economically free as well as the most successful. There is somewhat more variation in the lowest average scores. Sub-Saharan Africa is the least economically free and least successful while the Middle East / North Africa is the least politically free.  

# Most Successful Nations 

The most successful nations are shown below: 
```{r echo=FALSE, results='hide',message=FALSE, warning=FALSE}
# basic statistics --------------------------------------------------------
mean(success_na$success) 
# 0.6117207

min(success_na$success) 
# 0.3012778

success_na %>% top_n(-1) 
# South Sudan

max(success_na$success) 
# 0.9071793

success_na %>% top_n(1) 
# Tawain 

# find rank ---------------------------------------------------------------

# arrange data by success
success_order <- success_na %>% 
  arrange(desc(success))
nrow(success_order)
success_order$rank <- 1:179

# find the least successful countries
success_bot <- success_na %>% top_n(-10)

# find the most successful countries
success_top <- success_na %>% top_n(10)

# create tibbles keeping only countries and success scores
success_bot2 <- tibble("country" = success_bot$country_name, 
                       "success" = success_bot$success)
success_top2 <- tibble("country" = success_top$country_name, 
                       "success" = success_top$success)

# create tibbles keeping only countries and freedom/success scores
success_bot3 <- tibble("country" = success_bot$country_name, 
                       "econ" = success_bot$econ_freedom, 
                       "poli" = success_bot$poli_freedom,
                       "success" = success_bot$success)
success_top3 <- tibble("country" = success_top$country_name, 
                       "econ" = success_top$econ_freedom, 
                       "poli" = success_top$poli_freedom, 
                       "success" = success_top$success)
```

```{r}
success_top3
```

Of note when considering the top ten most successful nations in the world, the region fluctates much more than it does within the least successful. Four different regions are represented within the most successful nations - Europe, Middle East / North Africa, the Americas, and Asia-Pacific. Further, the rate of economic freedom is consistently high within the top ten. The mean rate of economic freedom for the top ten is 0.7783, compared to the average economic freedom rate for the whole data set which is 0.6126. While political freedom remains higher than the average for the whole data set, as well, with a mean of 0.841 for the top ten and 0.5809 for the entire set, there appears to be a much greater flucatation among the top ten in political freedom ratings. 

In terms of economic freedom, the minimum economic freedom rating for the top ten is 0.726, which is still over 0.10 higher than the mean for the set. Political freedom, on the other hand, shows a much different pattern. The lowest political freedom rating among the top ten most successful nation is 0.24 for the nation of Qatar. This is over 0.3 lower than the mean for political freedom in the whole data set. Thus, it is through this portion of data, that we begin to see the closer correlation between economic freedom and success than exists between political freedom and success. 

# Least Successful Nations 

The least success nations are shown below: 

```{r}
success_bot3
```

The first topic of note when considering the least successful nation is the lack of diversity in the regions represented. Only two regions - Sub-Saharan Africa and Asia-Pacific - appear in the bottom top nations whereas four different regions appeared in the top ten. 

The mean rate of economic freedom for the bottom ten is 0.5257, compared to the mean economic freedom overall for the whole set which is 0.6126. The mean rate of political freedom for the bottom ten is 0.27, compared the mean political freedom overall which is 0.5809. As was the trend with the top ten, there is significantly less fluctation in the economic freedom in the bottom ten countries than there is within the political freedom rating. While almost all the values in both columns stayed consistently below the means for political and economic freedom, political freedom had one outlier that managed to surpass the mean - Burkina Faso. 

# Political Freedom and Success

Under the initial research design for this paper, the goal was the track which economic systems and types of government saw the highest/lowest rates of success. While there was no readily available data set of economic systems outside of the economic freedom ratings, there was an alternative data set to political freedom that would have provided types of government, including autocracy, closed anocracy, open anocracy, democracy, and full democracy. This data set, however, included fewer nations within its study than Freedom House's Freedom Index. 

Further, while the categories provided by the polity data sets would have been ideal (i.e. the types of government), the each type of government only fell into one range of polity scores, with no outliers in the set. This meant that an autocracy would only fall between the polity score range of -10 to -6, closed anocracy between the range of -5 and -1, etc. Thus, little was gained from this model when these artifical ranges could also be introduced into Freedom House's Freedom Index. Since the Freedom Index included more nations, this seemed like the clear option. 

Below is the tibble created with proportional ranges and success scores. Each propoortional range represents a section of political freedom (i.e. a political freedom rating between 0 to 0.1, 0.1 to 0.2, etc.) and its corresponding average of success.

```{r echo=FALSE, results='hide',message=FALSE, warning=FALSE}
# calculate means of proportions ------------------------------------------
success_calc <- success_order

# find success rates for each proportions
suc0 <- success_calc$poli_freedom[success_calc$success == 0]
suc1 <- success_calc$poli_freedom[success_calc$success < .1]
suc2 <- success_calc$poli_freedom[success_calc$success < .2]
suc3 <- success_calc$poli_freedom[success_calc$success < .3]
suc4 <- success_calc$poli_freedom[success_calc$success < .4]
suc5 <- success_calc$poli_freedom[(success_calc$success > .5)&(success_calc$success< .6)]
suc6 <- success_calc$poli_freedom[(success_calc$success > .6)&(success_calc$success< .7)]
suc7 <- success_calc$poli_freedom[(success_calc$success > .7)&(success_calc$success< .8)]
suc8 <- success_calc$poli_freedom[(success_calc$success > .8)&(success_calc$success< .9)]
suc9 <- success_calc$poli_freedom[(success_calc$success > .9)&(success_calc$success< 1.0)]

# calculate means
calc_mean <- c(mean(suc0), mean(suc1), mean(suc2), mean(suc3), mean(suc4),
               mean(suc5), mean(suc6), mean(suc7), mean(suc8), 
               mean(suc9)) 
calc_mean

# create tibbles with proportions
mean_poli_prop <- 
  tibble("prop_success" = c("0 - 0.1", "0.1 - 0.2", "0.2 - 0.3", 
                            "0.3 - 0.4", "0.4 - 0.5", "0.5 - 0.6",
                            "0.6 - 0.7", "0.7 - 0.8", "0.8 - 0.9",
                            "0.9 - 1.0"),
         "mean_success" = calc_mean)

lm_poli_f <- lm(success ~ poli_freedom, data = success_na)
```

```{r}
mean_poli_prop
```

As can be seen in the above tibble, the average success rating rises consistently along with the political freedom with no outliers. Considering this under the terms of the afformentioned polity scores, then, this would mean that the success rating would rise as the polity score rose, leaving the democracies as the most successful type of government and the autocracy as the least successful. 

## Correlation between Political Freedom and Success

Turning the attention, then, towards the statistical relationship between political freedom and success, we will start by analyzing a linear regression graph of the two. 

```{r}
ggplot(data = success_na) + 
  geom_point(mapping = aes(x = poli_freedom, y = success)) +
  geom_abline()
```

As the graph shows, there is a positive correlation between political freedom and success; however, the data is much more scattered compared to the later graphing of economic freedom and success. 

Below is the linear regression equation for political freedom and success:

```{r}
lm_poli_f
```

A futher calculation of linear regression reveals that while the relationship between political freedom and success is statistically significant (with a p value of 8.067e-11), the correlation between the two is much weaker than that of economic freedom and success, with a  correlation coefficient of only 0.1692. This means that when the political freedom rating is at 100, the success rate of a nation will only rise (on average) 16.92 points. 

# Economic Freedom and Success

Following the same model that was utilized for political freedom, we will start by analzying the trends of economic freedom through proportional ranges. Below is a tibble of the results, with the first column denoting the ranges of economic freedom and the second showing the mean rate of success with the ranges: 

```{r echo=FALSE, results='hide',message=FALSE, warning=FALSE}
success_calc <- success_order

# find success rates for each proportions
xsuc1 <- success_calc$econ_freedom[(success_calc$success > .7)&(success_calc$success< .75)]
xsuc2 <- success_calc$econ_freedom[(success_calc$success > .75)&(success_calc$success< .8)]
xsuc3 <- success_calc$econ_freedom[(success_calc$success > .8)&(success_calc$success< .85)]
xsuc4 <- success_calc$econ_freedom[(success_calc$success > .85)&(success_calc$success< .9)]
xsuc5 <- success_calc$econ_freedom[(success_calc$success > .9)&(success_calc$success< .95)]
xsuc6 <- success_calc$econ_freedom[(success_calc$success > .95)&(success_calc$success< 1.0)]

# calculate means
calc_mean <- c(mean(xsuc1), mean(xsuc2), mean(xsuc3), 
               mean(xsuc4),mean(xsuc5), mean(xsuc6)) 
calc_mean

# create tibbles with proportions
mean_econ_prop <- 
  tibble("prop_success" = c("0.70 - 0.75", "0.75 - 0.80", "0.80 - 0.85", 
                            "0.85 - 0.90", "0.90 - 0.95", "0.95 - 1.0"),
         "mean_success" = calc_mean)
lm_econ_f <- lm(success ~ econ_freedom, data = success_na)
```

```{r}
mean_econ_prop
```

While the data at first appears to be following an abnormal pattern, with the 0.90-0.95 range holding a lower mean rate of success than the 0.80-0.85 range, this can be explained by analyzing the data itself. The only nation to score an economic freedom rating within the range of 0.90-0.95 was Taiwan. Rather than a mean success rate calculated from dozens of nations, then, as the other proportional ranges do, the last range relies solely on one nation, creating a less realiable mean rate of success. Thus, excluding the outlier of Taiwan, the proportional ranges follow the same positive relationship as political freedom, with the success rate increasing as the economic freedom rate increases. 

## Correlation between Economic Freedom and Success

Turning the attention, then, towards the statistical relationship between economic freedom and success, we will start by analyzing a linear regression graph of the two. 

```{r}
ggplot(data = success_na) + 
  geom_point(mapping = aes(x = econ_freedom, y = success)) +
  geom_abline()
```

As the graph shows, there is a strong positive correlation between economic freedom and success. Unlike the graph of political freedom, where data points appeared to be more scattered and random, the graph of economic freedom follows a much clearer pattern, with only a handful of outliers. 

Below is the linear regression equation for economic freedom and success:

```{r}
lm_econ_f
```

A futher calculation of linear regression reveals that the relationship between economic freedom and success is statistically significant (with a p value of < 2.2e-16). The correlation between the two is much stronger than that of political freedom and success, with a  correlation coefficient of 0.6862. This means that when the economic freedom rating is at 100, the success rate of a nation will rise (on average) 68.62 points. This rise in rate is over 50 points higher than that of political freedom. 

# Overall Correlation between Freedom Type and Success

In order to calculate the correlation between economic freedom, political freedom, and success within the same model, a multiple linear regression test will be utilized. 

```{r echo=FALSE, results='hide',message=FALSE, warning=FALSE}
lm_both <- lm(success ~ econ_freedom + poli_freedom, data = success_na)
```

```{r}
lm_both
```

As the outcome of the linear regression shows, economic freedom has a much stronger correlation to the success of a nation than political freedom does. An economic freedom rating of 100 percent will increase a nation's success rating by 62.008 percent whereas a political freedom rating of 100 percent will only increase a nation's success rating by 4.259 percent. 

# Determing the Effect of the Economic Prosperity Indicators 

When calculating the economic freedom of the country, the Heritage foundation utilized both the GDP and unemployments rates in their calculations. Since both of these variables were utilized in the calculation of success as indicators of economic prosperity, it is important to run a second linear regression to test the correlation between success and freedom rates with these two variables removed. 

The second multiple linear regression considers only the remaining four categories - safety, education, health, and lifestyle - when calculating the success of a given country:

```{r echo=FALSE, results='hide',message=FALSE, warning=FALSE}
# calculating success without economic indicators 

# in order to ensure that success was not biased towards economic freedom 
# as gdp and unemployment were both in the calculations of economic freedom 
# and the success variables, need to calculate success removing the economic 
# category to see if it has an effect on the linear regression 

# check over data 
head(success_data)
colnames(success_data)

# create a new tibble for percentages 
success_four <- tibble("country_name" = success_data$country_name, 
                      "region" = success_data$region)

# add in the economic freedom data
head(success_data$econ_freedom)
success_four$econ_freedom <- success_data$econ_freedom / 100

# add in the political freedom data 
head(success_data$poli_freedom)
success_four$poli_freedom <- success_data$poli_freedom / 100

# add in the crime index data
# since high crime index harms a country's success, we want to subtract 
# the pct by 1 to find a positive idicator (i.e. the safety index)
head(success_data$crime_index)
success_four$crime_index <- 1 - (success_data$crime_index / 100)

# add in the homicide rate data 
# subtract by 1 to find a positive indicator 
head(success_data$homicide)
success_four$homicide <- 1 - (success_data$homicide / 100)

# add in the enrollment data 
head(success_data$enrollment)
max_enrollment <- max(success_data$enrollment, na.rm = TRUE)
success_four$enrollment <- success_data$enrollment / max_enrollment

# add in the literacy data 
head(success_data$literacy)
success_four$literacy <- success_data$literacy / 100

# add in the life expectancy data
head(success_data$life_expectancy)
max_life <- max(success_data$life_expectancy, na.rm = TRUE)
success_four$life_expectancy <- success_data$life_expectancy / max_life

# add in the infant mortality data 
# subtract by 1 to find a positive indicator 
head(success_data$infant_mortality)
max_infant <- max(success_data$infant_mortality, na.rm = TRUE)
success_four$infant_mortality <- 
  1 - (success_data$infant_mortality / max_infant)

# add in the median income data 
head(success_data$median_income)
max_income <- max(success_data$median_income, na.rm = TRUE)
success_four$median_income <- success_data$median_income / max_income

# add in the happiness rating data 
head(success_data$happiness_rating)
max_happiness <- max(success_data$happiness_rating, na.rm = TRUE)
success_four$happiness <- success_data$happiness_rating / max_happiness

# calculate the success rating for each country 
# since many countries have at least one NA for their data, we cannot 
# simply add the columns up and will instead need to find the mean
ncol(success_four)
colnames(success_four)

success_four$success <- NA
success_four$success <- rowMeans(success_four[,5:12], na.rm=TRUE)

# remove rows that have NA for both variables in one category 

# any country that is missing data for both variables in any of the 
# categories needs to be removed
success_four <- success_pct

colnames(success_pct)

success_four <- 
  success_four[rowSums(is.na(success_four[c("crime_index", "homicide")])) != 2, ]
success_four <- 
  success_four[rowSums(is.na(success_four[c("enrollment", "literacy")])) != 2, ]
success_four <- 
  success_four[rowSums(is.na(success_four[c("life_expectancy", "infant_mortality")])) != 2, ]
success_four <- 
  success_four[rowSums(is.na(success_four[c("median_income", "happiness")])) != 2, ]

# count number of remaining countries from the original 195 
nrow(success_four)

# run a new linear regression with only the four categories factored into 
# the success score 

lm_both_four <- lm(success ~ econ_freedom + poli_freedom, data = success_four)

lm_five <- lm(success ~ econ + safe + educ + health + life, 
              data = success_combine)
```

```{r}
lm_both_four
```

Given that the correlation coefficients for economic freedom and political freedom remain the same (0.62008 and 0.04259, respectively) even when the economic prosperity category has been removed from consideration, we have ensured that the correlation was not skewed in favor of economic freedom by sharing two of the same indicators.  

When testing the correlation between the five indicators and the success rate for a nation, the results show that health indicators had the strongest correlation with a nation's success while economic factors had the weakest correlation. Thus, it is less surprising that the removal of the economic prosperty category had no effect on the overall correlation between economic freedom/political freedom and success. 

```{r}
lm_five
```

# Data Limitations  

While the ideal would have been to compare changes in success over the years, to analyze the effects that an increase in political freedom and economic freedom might have on a nation over time, this was not feasible due to the limitations of the data. Data reporting was infrequent from most nations, making it so that some variables had to be a combination of data from 2000 until 2017 to gain enough countries' results to make the set complete enough to work with. Thus, comparing the data over time was not feasible when the variables themselves were not individual years. Further, since a nation that was missing data from both variables within any of the given five categories had to be deleted from the set, this would create an even further lack of nations if the variables were considered by year, leaving only a handful of nations left. 

Further limitations of the data may be the way by which success was measured. While the goal was to create a measure of success that was not biased in favor of any one category, the variables that were included could be considered a "westernized ideal of success", meaning that certain variables included may be important to how a western nation views success of their nation but may not be important to other regions of the world. While this is certainly not the goal of this measure of success and including items such as the World Happiness Rating was meant to eliminate some of these biases, it is a factor to consider when reviewing this report. 

# Conculsion

The United States has a tendency to assume that the political freedom of a nation factors much more heavily into the success of a nation than it actually does. While the country gained its freedom by battling a monarchy and has gone to war over its perceived "noble" goal of spreading democracy throughout the world, this study provides some evidence that political freedom within a country may not be as important as other factors. While democracies do hold higher success ratings than other types of government, political freedom is not the deciding factor between a successful nation and a failing one. Among the most successful nations in the world, political freedom was largely mixed - instead, it was the economic freedom that factored much mor heavily into their success. With such a high correlation between economic freedom and success, attention should perhaps be turned away from promotting political freedom and instead towards promoting economic freedom. 

# Sources 

2018 Index of Economic Freedom. (2018). Retrieved from https://www.heritage.org/index/

Adjusted net national income per capita (current US$). (2018). Retrieved from https://data.worldbank.org/indicator/NY.ADJ.NNTY.PC.CD. 

Country Comparison: Infant Mortality Rate. (2018). Retrieved from https://www.cia.gov/library/publications/the-world-factbook/rankorder/2091rank.html. 

Country Comparison: Life Expectancy at Birth. (2018). Retrieved from https://www.cia.gov/library/publications/the-world-factbook/rankorder/2102rank.html. 

Country Comparison: Unemployment Rate. (2018). Retrieved from https://www.cia.gov/library/publications/the-world-factbook/rankorder/2129rank.html. 

Crime Index for Country 2018 Mid-Year. (2018). Retrieved from https://www.numbeo.com/crime/rankings_by_country.jsp. 

Field Listing: Literacy. (2018). Retrieved from https://www.cia.gov/library/publications/the-world-factbook/fields/print_2103.html. 

Freedom in the World 2018. (2018). Retrieved from https://freedomhouse.org/report/freedom-world/freedom-world-2018. 

GDP (current US$). (2018). Retrieved from https://data.worldbank.org/indicator/ny.gdp.mktp.cd?view=map. 

H. Wickham. ggplot2: Elegant Graphics for Data Analysis.
  Springer-Verlag New York, 2016.

Hadley Wickham (2017). tidyverse: Easily Install and Load the
  'Tidyverse'. R package version 1.2.1.
  https://CRAN.R-project.org/package=tidyverse
  
Hadley Wickham and Jennifer Bryan (2018). readxl: Read Excel
  Files. R package version 1.1.0.
  https://CRAN.R-project.org/package=readxl

Hadley Wickham, Romain François, Lionel Henry and Kirill Müller
  (2018). dplyr: A Grammar of Data Manipulation. R package version
  0.7.6. https://CRAN.R-project.org/package=dplyr

Intentional homicides (per 100,000 people). Retrieved from https://data.worldbank.org/indicator/VC.IHR.PSRC.P5?year_high_desc=true. 
R Core Team (2018). R: A language and environment for statistical
  computing. R Foundation for Statistical Computing, Vienna,
  Austria. URL https://www.R-project.org/.

RStudio Team (2015). RStudio: Integrated Development for R. RStudio, Inc., Boston, MA URL http://www.rstudio.com/.

School enrollment, secondary (% gross). (2018). Retrieved from https://data.worldbank.org/indicator/SE.SEC.ENRR. 

South, Andy 2011 rworldmap: A New R package for Mapping Global
  Data. The R Journal Vol. 3/1 : 35-43.

Stefan Milton Bache and Hadley Wickham (2014). magrittr: A
  Forward-Pipe Operator for R. R package version 1.5.
  https://CRAN.R-project.org/package=magrittr

World Happiness Report 2018. (2018). Retrieved from http://worldhappiness.report. 